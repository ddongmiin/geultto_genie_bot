# %%
'''
- Description
250125ì— ì‚¬ìš©ëœ ì „ì²´ ëŒ€ìƒ CRM ë©”ì„¸ì§€ ìŠ¤í¬ë¦½íŠ¸ì…ë‹ˆë‹¤. 
./history ê²½ë¡œì— ë°œì†¡í•œ ëŒ€ìƒ, ë©”ì„¸ì§€, tsê°€ ì €ì¥ë©ë‹ˆë‹¤.

- ì‚¬ìš©ëœ bigquery
crm_korean_newyear_01_agg: geultto_10th.super_user_mart ì„ ê¸°ë°˜ìœ¼ë¡œí•˜ëŠ” ì§‘ê³„ í…Œì´ë¸”
crm_korean_newyear_02_submit: ê°œë³„ ì¸ì›ì˜ ê¸€ì œì¶œ/íŒ¨ìŠ¤/ì°¨ê° history

- ê°œì„ í•„ìš”ì‚¬í•­
ë¹„ë™ê¸° -> ë™ê¸°ì‹ ë³€í™˜
ì†ë„í–¥ìƒ(í˜„ì¬ 361ì´ˆ)
'''

import warnings
warnings.filterwarnings('ignore')
from message_basic import *
import pandas as pd
import time

start = time.time()
query = 'SELECT * FROM geultto.geultto_10th.crm_korean_newyear_01_agg limit 1'
user_pd = get_bigquery(query).fillna(0)            

#ì‹¤í–‰ ì •ë³´ ì €ì¥
cnt = 0 #ë°œì†¡í•œ íšŸìˆ˜
df_sended = pd.DataFrame() #ë°œì†¡ëœ ë©”ì„¸ì§€ ì €ì¥í•˜ê¸°ìœ„í•œ ë°ì´í„°í”„ë ˆì„ ì´ˆê¸°í™”
name_list = []
text_list = [] # ë°œì†¡í•œ ë©”ì„¸ì§€
ts_list = [] #ë°œì†¡í•œ ë©”ì„¸ì§€ì˜ ts ì‹ë³„ì

query = 'SELECT * FROM geultto.geultto_10th.crm_korean_newyear_02_submit limit 1'
submit_count_pd = get_bigquery(query)
for _, row in user_pd.iterrows():
    temp_pd = submit_count_pd.loc[(submit_count_pd.name == row[1])]
    temp_pd = temp_pd.sort_values("step_number")# ì œì¶œì´ë ¥ ì˜¤ë¦„ì°¨ìˆœìœ¼ë¡œ ì •ë ¬
    submit_text = ""
    for _, row1 in temp_pd.iterrows():
        if row1[4] == "ì œì¶œì™„ë£Œ":
            submit_text = submit_text + "ğŸ“¬  "
        elif row1[4] == "íŒ¨ìŠ¤ì™„ë£Œ":
            submit_text = submit_text + "ğŸŒ´  "
        else:
            submit_text = submit_text + "ğŸ’¸  "

    #ê´€ì‹¬ ë ˆë²¨ì— ë”°ë¥¸ ì¶”ê°€ ë¬¸êµ¬ ì‘ì„±(1~4)
    #interest level
    ## ì§€ë‚œ í•œ ë‹¬ ë™ì•ˆ [ì´ ëŒ“ê¸€ ìˆ˜/ì´ëª¨ì§€ ë°˜ì‘ ìˆ˜]ë¡œ ì»¤ë®¤ë‹ˆí‹°ì— í™œê¸°ë¥¼ ë¶ˆì–´ë„£ì–´ì£¼ì…¨ì–´ìš”. ë•ë¶„ì— ë§ì€ ë¶„ë“¤ì´ ìœ ìµí•œ ì‹œê°„ì„ ë³´ëƒˆìŠµë‹ˆë‹¤. ì„¤ë‚ ì„ ë§ì•„ ë” ë§ì€ ë©‹ì§„ ì´ì•¼ê¸°ë¥¼ ê¸°ë‹¤ë¦¬ê³  ìˆì„ê²Œìš”! 
    if row[16] == 1:
        interest_text = f'ì„¤ë‚ ì„ ë§ì•„ ìƒˆë¡œìš´ ë§ˆìŒìœ¼ë¡œ ê´€ì‹¬ìˆëŠ” ê¸€ë“¤ì„ ì½ê³  ì“°ë ˆë“œë¥¼ ë‚¨ê²¨ë³´ì‹œëŠ” ê±´ ì–´ë– ì‹ ê°€ìš”? ì»¤ë®¤ë‹ˆí‹°ì—ì„œ í™œë™í•˜ê³  ê³„ì‹¤ {row[12]}ë‹˜ì˜ ëª¨ìŠµì„ ê¸°ëŒ€í•˜ê³  ìˆì„ê²Œìš”. ğŸŒ±'
    elif row[16] == 2:
        interest_text = f'ì§€ê¸ˆê¹Œì§€ í™œë™í•˜ì…¨ë˜ ê²ƒì„ ìˆ«ìë¡œ ë³´ë‹ˆ ê°íšŒê°€ ìƒˆë¡­ì§€ ì•Šë‚˜ìš”? ì„¤ë‚ ì„ ë§ì•„ ê´€ì‹¬ ìˆë˜ ì±„ë„ í˜¹ì€ ì½”ì–´ ì±„ë„ì— ì ì‹œ ë“¤ëŸ¬ ìƒˆí•´ ì¸ì‚¬ë¥¼ ë‚˜ëˆ ë³´ëŠ” ê±´ ì–´ë– ì„¸ìš”? ì•ìœ¼ë¡œë„ í’ì„±í•œ ê¸€ë˜ë¥¼ í•¨ê»˜ ë§Œë“¤ì–´ ê°€ìš”! ğŸŒ±'
    elif row[16] == 3:
        interest_text = f'ì§€ê¸ˆê¹Œì§€ í™œë™í•˜ì…¨ë˜ ê²ƒì„ ìˆ«ìë¡œ ë³´ë‹ˆ ê°íšŒê°€ ìƒˆë¡­ì§€ ì•Šë‚˜ìš”? ë•ë¶„ì— ë§¤ì£¼ ì»¤ë®¤ë‹ˆí‹°ê°€ ë” í’ì„±í•´ì§€ê³  ìˆì–´ìš”. ì£¼ê¸°ì ìœ¼ë¡œ ê¸€ë˜ì— ê´€ì‹¬ì„ ê°€ì§€ê³  í™œë™í•´ ì£¼ì…”ì„œ ê°ì‚¬í•´ìš”. ì•ìœ¼ë¡œë„ í’ì„±í•œ ê¸€ë˜ë¥¼ í•¨ê»˜ ë§Œë“¤ì–´ ê°€ìš”! ğŸŒ±'
    else:
        interest_text = f'ë•ë¶„ì— ì»¤ë®¤ë‹ˆí‹°ê°€ ë” í’ì„±í•´ì§€ê³  ìˆì–´ìš”. ë§¤ì£¼ ê¸€ë˜ì— ê´€ì‹¬ì„ ê°€ì§€ê³  í™œë™í•´ ì£¼ì…”ì„œ ì •ë§ ê°ì‚¬í•´ìš”. í•­ìƒ ì‘ì›í•©ë‹ˆë‹¤! ë‚¨ì€ ê¸°ê°„ë„ ì§€ê¸ˆì²˜ëŸ¼ë§Œ~ ì•„ì‹œì£ ? ğŸ˜‰'

    
    #ì œì¶œ ë ˆë²¨ì— ë”°ë¥¸ ì¶”ê°€ ë¬¸êµ¬ ì‘ì„±(1~4)
    #submit level :    #ì„¤ë‚ ì„ ë§ì•„ ë˜ ë‹¤ë¥¸ ë©‹ì§„ ê¸€ì„ ê¸°ë‹¤ë¦¬ê³  ìˆì„ê²Œìš”. 
    if row[17] == 1:
        submit_add_text = f'ì €í¬ëŠ” í•­ìƒ {row[12]}ë‹˜ì˜ ê¸€ì„ ê¸°ë‹¤ë¦¬ê³  ìˆì–´ìš”. í•¨ê»˜ ë‚˜ëˆ„ëŠ” ê¸€ë“¤ì´ ë” ë§ì•„ì§€ê¸¸ ê¸°ëŒ€í•˜ë©°, ì„¤ ì—°íœ´ ë™ì•ˆ ê¸€ê°ì„ ë¯¸ë¦¬ ì ì–´ë³´ì‹œëŠ” ê±´ ì–´ë–¨ê¹Œìš”~?'
    elif row[17] == 2:
        submit_add_text = f'í¬ê¸°í•˜ì§€ ì•Šê³  ê¾¸ì¤€íˆ ê¸€ì„ ì œì¶œí•˜ë ¤ ë…¸ë ¥í•´ ì£¼ì…”ì„œ ê°ë™ì´ì—ìš” ğŸ˜Š ë” íŒŒì´íŒ… ë„˜ì¹˜ê²Œ ì„¤ ì—°íœ´ ë™ì•ˆ ê¸€ê°ì„ ë¯¸ë¦¬ ì ì–´ë³´ì‹œëŠ” ê±´ ì–´ë– ì„¸ìš”~?'
    elif row[17] == 3:
        submit_add_text = f'ê¾¸ì¤€íˆ ê¸€ì„ ì˜ ì œì¶œí•´ ì£¼ì…”ì„œ ê°ì‚¬í•´ìš”! ë‚¨ì€ ê¸°ê°„ë„ ì´ë ‡ê²Œ ê³„ì† ê°€ë³´ìê³ ~~'
    else:
        submit_add_text = f'ì´ë²ˆ 10ê¸° ë™ì•ˆ 7ê°œ ì´ìƒì˜ ê¸€ì„ ì œì¶œí•˜ë©° ë³´ì—¬ì£¼ì‹  ì—´ì •ê³¼ ê¸€ë“¤ì— ê¹Šì´ ê°ì‚¬ë“œë ¤ìš”. {row[12]}ë‹˜ì˜ í™œë™ì´ ë‹¤ë¥¸ ì´ë“¤ì—ê²Œë„ í° ì˜ê°ì´ ë˜ê³  ìˆë‹¤ëŠ” ì‚¬ì‹¤, ì´ë¯¸ ì•„ì‹œì£ ? ì•ìœ¼ë¡œë„ ê³„ì† ì¢‹ì€ ê¸€ ê¸°ëŒ€í• ê²Œìš”!'
        
        
    #ì»¤í”¼ì±— ë ˆë²¨ì— ë”°ë¥¸ ì¶”ê°€ ë¬¸êµ¬ ì‘ì„±(0~3)    
    if row[18] == 0:
        coffee_text = f'ì•—, {row[12]}ë‹˜! ì»¤í”¼ì±—ì„ í•œ ë²ˆë§Œ ì§„í–‰í•´ë„ ì»¤í”¼ì±— ë ˆë²¨ì´ +1 ëœë‹¤ëŠ” ì‚¬ì‹¤ ì•„ì‹œë‚˜ìš”? ê´€ì‹¬ ìˆë˜ 4ì±„ë„ í˜¹ì€ ì½”ì–´ ì±„ë„ì—ì„œ ì»¤í”¼ì±—ì„ ì§„í–‰í•´ ë³´ì‹œëŠ” ê±´ ì–´ë– ì‹¤ê¹Œìš”~?'
    elif row[18] == 1:
        coffee_text = f'ì²« ì»¤í”¼ì±—ì€ ì–´ë– ì…¨ë‚˜ìš”? í•´ë‹¹ ê²½í—˜ì´ ì¢‹ì€ ê¸°ì–µìœ¼ë¡œ ë‚¨ì•˜ìœ¼ë©´ ì¢‹ê² ì–´ìš” :) ë‹¤ìŒ ì»¤í”¼ì±—ì—ì„œë„ ìƒˆë¡œìš´ ì‚¬ëŒë“¤ê³¼ ì´ì•¼ê¸°ë¥¼ ë‚˜ëˆ„ë©° ë˜ ë‹¤ë¥¸ ì˜ê°ì„ ì–»ì–´ë³´ì„¸ìš”~'
    elif row[18] == 2:
        coffee_text = f'ë²Œì¨ ì—¬ëŸ¬ ì°¨ë¡€ ì»¤í”¼ì±—ì„ ì§„í–‰í•˜ì…¨ë‹¤ë‹ˆ, ì •ë§ ë©‹ìˆì–´ìš”! ğŸŒŸ ì´ë ‡ê²Œ ë©‹ì§„ ì°¸ì—¬ë¡œ ì»¤ë®¤ë‹ˆí‹°ì— í™œë ¥ì„ ë”í•´ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤. ì•ìœ¼ë¡œë„ ì—¬ëŸ¬ë¶„ì˜ ì´ì•¼ê¸°ë¥¼ ë‚˜ëˆ„ê³ , ë‹¤ë¥¸ ë©¤ë²„ë“¤ê³¼ ë”ìš± ê¹Šì´ ì—°ê²°ë˜ëŠ” ì‹œê°„ì„ ë§Œë“¤ì–´ë³´ì„¸ìš”~'
    else: # row[18] == 3
        coffee_text = f'ì»¤í”¼ì±— ì±„ë„ì—ì„œ í™œì•½í•´ ì£¼ì…”ì„œ ì •ë§ ê°ì‚¬ë“œë ¤ìš”! ğŸ’¬ ë•ë¶„ì— ì»¤ë®¤ë‹ˆí‹°ê°€ ë” ë”°ëœ»í•˜ê³  í’ì„±í•´ì§€ê³  ìˆë‹¤ëŠ” ê±° ì•„ì‹œì£ ~?! ì´ë¯¸ ë§ì€ ë©¤ë²„ë“¤ê³¼ ì»¤í”¼ì±—ì„ í•˜ì…¨ì§€ë§Œ, ì•ìœ¼ë¡œë„ ê¸°ëŒ€í• ê²Œìš”. ê³„ì†í•´ì„œ í™œë°œí•œ êµë¥˜ì™€ ê´€ê³„ë¥¼ ë§Œë“¤ì–´ ë‚˜ê°€ì£¼ì„¸ìš”. ğŸŒŸ'
           
    #ì „ì²´ ë ˆë²¨ì— ë”°ë¥¸ ì¶”ê°€ ë¬¸êµ¬ ì‘ì„±
    #group rank(0~3)
    if row[20] == 1:
        final_ment = f'ë§ˆì§€ë§‰ìœ¼ë¡œ {row[12]}ë‹˜ì—ê²Œë§Œ ë§ì”€ë“œë¦¬ëŠ” ê±´ë°..(ì†ë‹¥ì†ë‹¥) ê¸€ë˜ í™œë™ ì§€ìˆ˜ ìƒìœ„ 10% ì•ˆì— ë“œì…¨ì–´ìš”~ ëŠ˜ í™œë°œí•˜ê²Œ í™œë™í•´ ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤. ë‚¨ì€ ê¸°ê°„ë„ ì‘ì›í• ê²Œìš”! ìƒˆí•´ ë³µ ë§ì´ ë°›ìœ¼ì„¸ìš”!ğŸ™‡ğŸ»â€â™€ï¸'
    elif row[20] == 2:
        final_ment = f'ë§ˆì§€ë§‰ìœ¼ë¡œ {row[12]}ë‹˜ì€ ê¸€ë˜ì—ì„œ ì–´ë–¤ í™œë™ë“¤ì„ ë” í•˜ê³  ì‹¶ìœ¼ì‹ ê°€ìš”? ì•ìœ¼ë¡œ í™œë°œí•œ í™œë™ì„ ì‘ì›í• ê²Œìš”. ì €í¬ëŠ” ê¸€ë˜ 10ê¸°ê°€ ëë‚  ì¦ˆìŒì— ë” ë°œì „ëœ ëª¨ìŠµìœ¼ë¡œ ë§Œë‚˜ìš”! ìƒˆí•´ ë³µ ë§ì´ ë°›ìœ¼ì„¸ìš”!ğŸ™‡ğŸ»â€â™€ï¸'
    elif row[20] == 3:
        final_ment = f'ë§ˆì§€ë§‰ìœ¼ë¡œ {row[12]}ë‹˜! ì„±ìœ¤ë‹˜ì´ ê³µì§€ì‚¬í•­ì— ì˜¬ë¦° íšŒê³  ì„¤ë¬¸ì„ ë‚¨ê²¨ë³´ì‹œë©´ ì–´ë–¨ê¹Œìš”? ì €í¬ê°€ ë„ìš¸ ìˆ˜ ìˆëŠ” ë¶€ë¶„ì´ ìˆë‹¤ë©´ ë•ê³  ì‹¶ì–´ìš”. ë‚¨ì€ ê¸°ê°„ ë™ì•ˆì—ë„ ì¡°ê¸ˆì”© ê´€ì‹¬ì„ ê°€ì ¸ì£¼ì‹¤ ê±°ë¼ ë¯¿ì„ê²Œìš”. ìƒˆí•´ ë³µ ë§ì´ ë°›ìœ¼ì„¸ìš”!ğŸ™‡ğŸ»â€â™€ï¸'
    else:
        final_ment = f'ë§ˆì§€ë§‰ìœ¼ë¡œ {row[12]}ë‹˜ì—ê²Œë§Œ ë§ì”€ë“œë¦¬ëŠ” ê±´ë°..(ì†ë‹¥ì†ë‹¥) ê¸€ë˜ í™œë™ ì§€ìˆ˜ íƒ‘ ë­ì»¤ì„¸ìš”!! ì´ë²ˆ 10ê¸° ë™ì•ˆ ì»¤í”¼ì±—, ì œì¶œ, í™œë™ ê·¸ ì–´ëŠ ê²ƒ í•˜ë‚˜ ë†“ì¹˜ì§€ ì•Šê³  ìµœê³  ë ˆë²¨ì„ ë‹¬ì„±í•˜ì…¨ë‹¤ë‹ˆ ì§„ì§œ ë©‹ìˆì–´ìš”~ ë‚¨ì€ ê¸°ê°„ë„ í™œë°œí•œ í™œë™ì„ ì‘ì›í• ê²Œìš”. ìƒˆí•´ ë³µ ë§ì´ ë°›ìœ¼ì„¸ìš”!ğŸ™‡ğŸ»â€â™€ï¸'

    if row[1] == 'ë³€ì„±ìœ¤':
        final_ment = '''
    
    ğŸŒŸ ì„±ìœ¤ë‹˜ì—ê²Œ CRMíŒ€ì˜ ê¹œì§ ë©”ì„¸ì§€! ğŸŒŸ
    *ë™ë¯¼*: ì¡´ê²½í•©ë‹ˆë‹¤ í•„ìŠ¹ğŸ«¡
    *ì •í˜„*: í•­ìƒ ë’¤ì—ì„œ ìŠ¬ë‚ìŠ¬ë‚ ë³´ê³  ë°°ìš°ëŠ”ê²Œ ë§ì•„ìš”~ í¬ì¸íŠ¸ ë§ì´ ëª¨ì•„ì„œ ë„¥ìŠ¤íŠ¸ ê¸€ë˜ ëª¨ì„ì—ë„ í•¨ê»˜í•´ë³´ê² ìŠµë‹ˆë‹·!ğŸ«¡
    *ì´íƒœ*: ëŠ˜ ë”°ëœ»í•˜ê³  ë² í‘¸ëŠ” ëª¨ìŠµì— ë§ì€ ì˜ê°ê³¼ ê·€ê°ì„ ë°›ìŠµë‹ˆë‹¤. ì¶©ì„±ì¶©ì„±
    *ì—°ì°¬*: ê¸€ë˜ë¼ëŠ” ì†Œì¤‘í•œ ê³µê°„ì„ ë§ˆë ¨í•´ì£¼ì…”ì„œ ë„ˆë¬´ ê°ì‚¬í•©ë‹ˆë‹¤! ì •ë§ ë§ì€ ê¸°íšŒì™€ ìƒê°ì„ ì–»ê²Œë˜ì—ˆì–´ìš”. ë‹¤ë¥¸ì‚¬ëŒì—ê²Œ ì„ ì‚¬í•œ ê²ƒë³´ë‹¤ ë” ë§ì´ ëŒë ¤ë°›ìœ¼ì‹œê¸¸!
    *ì„ì •*: ì„±ìœ¤ë‹˜ ë•ë¶„ì— ëˆ ëŒ€ì‹  ê°€ì¹˜ë¡œ ì‚¬ëŒì„ ì´ë„ëŠ” ë°©ë²•ì„ ë°°ì› ìŠµë‹ˆë‹¤. ì•ìœ¼ë¡œë„ í•¨ê»˜í•´ìš”~
        '''
    active_imoji = 'â¤ï¸â€ğŸ”¥' * int(row[16])
    submit_imoji = 'âœğŸ»' * int(row[17])
    coffee_imoji = 'â˜•ï¸' * int(row[18])

    text = f'''
ğŸ§§{row[12]}ë‹˜! ë³µì£¼ë¨¸ë‹ˆê°€ ë„ì°©í–ˆì–´ìš”ğŸ§§

 ğŸš© *{row[12]}ë‹˜ì˜ ê¸€ë˜ ë ˆë²¨*
  â€¢ í™œë™ ë ˆë²¨(1~4): {active_imoji}
  â€¢ ê¸€ ì œì¶œ ë ˆë²¨(1~4): {submit_imoji}
  â€¢ ì»¤í”¼ì±— ë ˆë²¨(0~3): {coffee_imoji} 
    
    
 ğŸ” *{row[12]}ë‹˜ì˜ í™œë™ ìš”ì•½* 
  â€¢ ë©”ì‹œì§€ {row[6]} ê°œ/ ëŒ“ê¸€ {row[7]} ê°œ / ì´ëª¨ì§€ {row[8]} ê°œ 

> {interest_text}ğŸŒ±
    
    
 ğŸ“ *{row[12]}ë‹˜ì˜ ê¸€ ì œì¶œ ë‚´ì—­*
  â€¢ ì´ {row[15]}íšŒ ì œì¶œ / {row[14]}íšŒ íŒ¨ìŠ¤
  â€¢ {submit_text} 
  â€¢ ë²”ë¡€: ğŸ“¬(ì œì¶œì™„ë£Œ), ğŸŒ´(íŒ¨ìŠ¤), ğŸ’¸(ì°¨ê°)

> {submit_add_text}ğŸ’ªğŸ»ğŸ’ªğŸ»
    
    
 â˜•ï¸ *{row[12]}ë‹˜ì˜ ì»¤í”¼ì±— ë‚´ì—­*
  â€¢ ì´ {row[13]} ë²ˆì˜ ì»¤í”¼ì±— ì§„í–‰

> {coffee_text}
    
 ğŸ‘« *{row[12]}ë‹˜ì˜ íŒ”ë¡œì›Œ*

> ì§€ê¸ˆê¹Œì§€ ë‚˜ì—ê²Œ ê´€ì‹¬ì„ ë³´ì—¬ì¤€ íŒ”ë¡œì›Œ TOP 5ëª…ì„ ì†Œê°œí•´ë“œë¦´ê²Œìš”. í˜¹ì‹œ ì¹œí•´ì§€ê³  ì‹¶ìœ¼ì‹  ë¶„ì´ ìˆë‹¤ë©´ ì»¤í”¼ì±—ì„ ì‹ ì²­í•´ë³´ëŠ” ê±´ ì–´ë– ì„¸ìš”? ì‚¬ì´ë„ ëˆë…í•´ì§€ê³  í¬ì¸íŠ¸ë„ ì–»ëŠ” 1ì„ 2ì¡°ì˜ ê¸°íšŒ!âœŒğŸ»

  â€¢ ğŸ’˜ë‚˜ì—ê²Œ ë§ì€ ê´€ì‹¬ì„ ë³´ë‚´ì¤€ íŒ”ë¡œì›ŒğŸ’˜: {row[11]}


ğŸ§§ ë‚˜ê°€ëŠ” ë§

> ì„¤ ì—°íœ´ë¥¼ ë§ì•„ ê³„íší•˜ê³  ê³„ì‹  ì¼ì´ ìˆìœ¼ì‹ ê°€ìš”? ë¬´ì—‡ì„ í•˜ì‹œë“  ì¢‹ì§€ë§Œ, ì´ë²ˆ ê¸´ ì—°íœ´ ë™ì•ˆ í‘¹ ì‰¬ëŠ” ê²ƒë„ ìŠì§€ ë§ˆì„¸ìš”~
> {final_ment}
    '''
    result = send_message_to_user(row[0],text)
    text_list.append(text)
    ts_list.append(result)
    name_list.append(row[1])
    
    #ëŒ“ê¸€ë¡œ ì±„ë„ ë¦¬ìŠ¤íŠ¸ ì „ë‹¬í•˜ê¸°
    # message_to_thread = f'''
    # ì°¸ì—¬í•˜ì‹  ì±„ë„ë¦¬ìŠ¤íŠ¸ëŠ” {row[10]} ì…ë‹ˆë‹¤! 
    # '''
    # send_reply_to_thread('D088BCH43V2',result,message_to_thread)
    cnt += 1
    df_temp = pd.DataFrame({'name':name_list,'text':text_list,'ts':ts_list})    
    if cnt % 100 == 0:
        time.sleep(1)
        print(f'{cnt}ëª…, {row[1]}ê¹Œì§€ ì „ë‹¬ì™„ë£Œ')
time_record = time.strftime("%Y%m%d_%H%M%S", time.localtime(time.time()))
pd.concat([df_sended,df_temp]).to_csv(f'./history/message_sended_{time_record}.csv', encoding = 'utf-8-sig')
print(f'ìµœì¢… {cnt}ëª… ì „ë‹¬ì™„ë£Œ')
end = time.time()
print(round(end - start), 'ì´ˆ ì†Œìš”ë¨')