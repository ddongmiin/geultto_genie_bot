# %%
'''
250119ì— ì‚¬ìš©ëœ ìš´ì˜ì§„ 34ëª… ëŒ€ìƒ CRM ë©”ì„¸ì§€ ìŠ¤í¬ë¦½íŠ¸ì…ë‹ˆë‹¤. 
í…ŒìŠ¤íŠ¸í•˜ë ¤ë©´
query,query2 ë¶€ë¶„ ëª¨ë‘ where ì¡°ê±´ìœ¼ë¡œ ì‚¬ëŒì„ ì§€ì •í•˜ì—¬ ë³´ë‚´ë©´ ì¦‰ì‹œ ì§€ë‹ˆë´‡ìœ¼ë¡œ ë³´ë‚´ì§‘ë‹ˆë‹¤.
34ëª… ê¸°ì¤€ 23ì´ˆ ì†Œìš”ë˜ì—ˆìœ¼ë©°, ë¡œì»¬csvì— ë°œì†¡í•œ ë©”ì„¸ì§€ì™€ í•´ë‹¹ ê¸€ì˜ tsê°€ ì €ì¥ë©ë‹ˆë‹¤.

crm_korean_newyear_01_agg: geultto_10th.super_user_mart ì„ ê¸°ë°˜ìœ¼ë¡œí•˜ëŠ” ì§‘ê³„ í…Œì´ë¸”
korean_newyear_crm_02_submit: ê°œë³„ ì¸ì›ì˜ ê¸€ì œì¶œ/íŒ¨ìŠ¤/ì°¨ê°ì´ history
'''

import warnings
warnings.filterwarnings('ignore')
from message_basic import *
import pandas as pd
import time

start = time.time()
query = 'SELECT * FROM geultto.geultto_10th.crm_korean_newyear_01_agg limit 10'
user_pd = get_bigquery(query).fillna(0)            

#ì‹¤í–‰ ì •ë³´ ì €ì¥
cnt = 0 #ë°œì†¡í•œ íšŸìˆ˜
df_sended = pd.DataFrame() #ë°œì†¡ëœ ë©”ì„¸ì§€ ì €ì¥í•˜ê¸°ìœ„í•œ ë°ì´í„°í”„ë ˆì„ ì´ˆê¸°í™”
text_list = [] # ë°œì†¡í•œ ë©”ì„¸ì§€
ts_list = [] #ë°œì†¡í•œ ë©”ì„¸ì§€ì˜ ts ì‹ë³„ì

query2 = 'SELECT * FROM geultto.geultto_10th.korean_newyear_crm_02_submit limit 10'
submit_count_pd = get_bigquery(query2)

for _, row in user_pd.iterrows():
    temp_pd = submit_count_pd.loc[(submit_count_pd.name == row[1])]
    temp_pd = temp_pd.sort_values("step_number") # ì œì¶œì´ë ¥ ì˜¤ë¦„ì°¨ìˆœìœ¼ë¡œ ì •ë ¬
    submit_text = ""
    for _, row1 in temp_pd.iterrows():
        if row1[4] == "ì œì¶œì™„ë£Œ":
            submit_text = submit_text + "ğŸ“¬  "
        elif row1[4] == "íŒ¨ìŠ¤ì™„ë£Œ":
            submit_text = submit_text + "ğŸ“­  "
        else:
            submit_text = submit_text + "ğŸ’¸  "
    
    #ê´€ì‹¬ ë ˆë²¨ì— ë”°ë¥¸ ì¶”ê°€ ë¬¸êµ¬ ì‘ì„±(1~4)
    #interest level
    ## ì§€ë‚œ í•œ ë‹¬ ë™ì•ˆ [ì´ ëŒ“ê¸€ ìˆ˜/ì´ëª¨ì§€ ë°˜ì‘ ìˆ˜]ë¡œ ì»¤ë®¤ë‹ˆí‹°ì— í™œê¸°ë¥¼ ë¶ˆì–´ë„£ì–´ì£¼ì…¨ì–´ìš”. ë•ë¶„ì— ë§ì€ ë¶„ë“¤ì´ ìœ ìµí•œ ì‹œê°„ì„ ë³´ëƒˆìŠµë‹ˆë‹¤. ì„¤ë‚ ì„ ë§ì•„ ë” ë§ì€ ë©‹ì§„ ì´ì•¼ê¸°ë¥¼ ê¸°ë‹¤ë¦¬ê³  ìˆì„ê²Œìš”! 
    if row[16] == 1:
        interest_text = 'ì§€ë‚œ 3ê°œì›”ë™ì•ˆ ê´€ì‹¬ì§€ìˆ˜ê°€ ì¡°ê¸ˆ ë‚®êµ°ìš”..! í•˜ì§€ë§Œ, ì„¤ë‚ ì„ ë§ì•„ ìƒˆë¡œìš´ ë§ˆìŒìœ¼ë¡œ ì‹œì‘ í•´ë³´ì‹œëŠ” ê±´ ì–´ë–¨ê¹Œìš”? ì„¤ ì—°íœ´ë™ì•ˆ ì½”ì–´ì—ì„œ ì œì¶œëœ ê¸€ë“¤ì„ ì½ê³  ë¶€ë‹´ì—†ì´ ì“°ë ˆë“œë¥¼ ë‚¨ê²¨ë³´ì‹œëŠ”ê±´ ì–´ë– ì‹ ê°€ìš”? ì»¤ë®¤ë‹ˆí‹°ì—ì„œ í™œë™í•˜ê³  ê³„ì‹¤ ì—¬ëŸ¬ë¶„ë“¤ì˜ ëª¨ìŠµì„ ê¸°ëŒ€í•˜ê³  ìˆì„ê²Œìš”.'
    elif row[16] == 2:
        interest_text = 'ì§€ê¸ˆê¹Œì§€ í™œë™ í•˜ì…¨ë˜ê±¸ ìˆ«ìë¡œ ë³´ë‹ˆ ê°íšŒê°€ ìƒˆë¡­ì§€ ì•Šë‚˜ìš”? ì„¤ë‚ ì„ ë§ì•„ ê´€ì‹¬ìˆë˜ ì±„ë„ í˜¹ì€ ì½”ì–´ì±„ë„ì— ì ì‹œ ë“¤ëŸ¬ì„œ ìƒˆí•´ ì¸ì‚¬ë¥¼ ë‚˜ëˆ ë³´ëŠ” ê±´ ì–´ë– ì„¸ìš”? ì•ìœ¼ë¡œë„ í’ì„±í•œ ê¸€ë˜ë¥¼ í•¨ê»˜ ë§Œë“¤ì–´ ê°€ìš”! ğŸŒ±'
    elif row[16] == 3:
    #ë‚˜ë¦„ ì—´ì‹¬íˆ í™œë™
        interest_text = 'ì§€ê¸ˆê¹Œì§€ í™œë™ í•˜ì…¨ë˜ê±¸ ìˆ«ìë¡œ ë³´ë‹ˆ ê°íšŒê°€ ìƒˆë¡­ì§€ ì•Šë‚˜ìš”? ë•ë¶„ì— ë§¤ì£¼ ì»¤ë®¤ë‹ˆí‹°ê°€ ë” í’ì„±í•´ì§€ê³  ìˆì–´ìš”. ì£¼ê¸°ì ìœ¼ë¡œ ê¸€ë˜ì— ê´€ì‹¬ì„ ê°€ì§€ê³  í™œë™í•´ ì£¼ì…”ì„œ ê°ì‚¬í•´ìš”. ì•ìœ¼ë¡œ í’ì„±í•œ ê¸€ë˜ë¥¼ í•¨ê»˜ ë§Œë“¤ì–´ ê°€ìš”! ğŸŒ±'
    else:
    #ì™„ì „ ì—´ì‹¬íˆ í™œë™
        interest_text = 'ë•ë¶„ì— ì»¤ë®¤ë‹ˆí‹°ê°€ ë” í’ì„±í•´ì§€ê³  ìˆì–´ìš”. ë§¤ì£¼ ì»¤ë®¤ë‹ˆí‹°ì— ê´€ì‹¬ì„ ê°€ì§€ê³  í™œë™í•´ ì£¼ì…”ì„œ ì •ë§ ê°ì‚¬í•´ìš”.âš¡ í•­ìƒ ì‘ì›í•©ë‹ˆë‹¤! ë‚¨ì€ ê¸°ê°„ë„ ì§€ê¸ˆì²˜ëŸ¼ë§Œ~ ì•„ì‹œì£ ?'
    
    #ì œì¶œ ë ˆë²¨ì— ë”°ë¥¸ ì¶”ê°€ ë¬¸êµ¬ ì‘ì„±(1~4)
    #submit level :    #ì„¤ë‚ ì„ ë§ì•„ ë˜ ë‹¤ë¥¸ ë©‹ì§„ ê¸€ì„ ê¸°ë‹¤ë¦¬ê³  ìˆì„ê²Œìš”. 
    if row[17] == 1:
    #ì ˆë°˜ ì´ë‚´ ì¬ì¶œ
        submit_add_text = 'ì €í¬ëŠ” í•­ìƒ ì—¬ëŸ¬ë¶„ë“¤ì˜ ê¸€ì„ ê¸°ë‹¤ë¦¬ê³  ìˆì–´ìš”. í•¨ê»˜ ë‚˜ëˆ„ëŠ” ê¸€ë“¤ì´ ë” ë§ì•„ì§€ê¸¸ ê¸°ëŒ€í•˜ë©°, ì„¤ ì—°íœ´ë™ì•ˆ ê¸€ê°ì„ ë¯¸ë¦¬ ì ì–´ë³´ì‹œëŠ”ê±´ ì–´ë–¨ê¹Œìš”~?'
    elif row[17] == 2:
    #ì¡°ê¸ˆ ì•„ì‰½ê²Œ ì œì¶œ 4,5
        submit_add_text = 'í˜¹ì‹œ ë†“ì¹œ ê¸€ë“¤ì´ ì•„ì‰¬ìš°ì…¨ë‚˜ìš”? ğŸ˜Š ì•„ì‰¬ìš´ë§Œí¼ ë” ë½œì´ì´íŒ… ë„˜ì¹˜ê²Œ ì„¤ ì—°íœ´ë™ì•ˆ ê¸€ê°ì„ ë¯¸ë¦¬ ì ì–´ë³´ì‹œëŠ”ê±´ ì–´ë– ì„¸ìš”~?'
    elif row[17] == 3:
    #6,7 ì œì¶œ : ë³´í†µ
        submit_add_text = 'ê·¸ëŸ¼ì—ë„ í•­ìƒ ê¾¸ì¤€íˆ ì°¸ì—¬í•´ ì£¼ì…”ì„œ ê°ì‚¬í•´ìš”! ë‚¨ì€ê¸°ê°„ë„ ì´ë ‡ê²Œ ê³„ì† ê°€ë³´ìê³ ~~'
    else:
    #7ë²ˆ ì´ìƒ ì œì¶œ
        submit_add_text = f'ì´ë²ˆ 10ê¸°ë™ì•ˆ 7ê°œ ì´ìƒì˜ ê¸€ì„ ì œì¶œí•˜ë©° ë³´ì—¬ì£¼ì‹  ì—´ì •ê³¼ ê¸€ë“¤ì— ê¹Šì´ ê°ì‚¬ë“œë¦½ë‹ˆë‹¤. ë‹¹ì‹ ì˜ í™œë™ì´ ë‹¤ë¥¸ ì´ë“¤ì—ê²Œë„ í° ì˜ê°ì´ ë˜ê³  ìˆë‹¤ëŠ” ì‚¬ì‹¤, ì´ë¯¸ ì•„ì‹œì£ ? ì•ìœ¼ë¡œë„ ê³„ì† ì¢‹ì€ ê¸€ ê¸°ëŒ€í• ê²Œìš”! '
        
        
    #ì»¤í”¼ì±— ë ˆë²¨ì— ë”°ë¥¸ ì¶”ê°€ ë¬¸êµ¬ ì‘ì„±(0~3)
    if row[18] == 0:
    #ì»¤í”¼ì±— í•œë²ˆë„ ì•ˆí•œê±°
        coffee_text = 'ì•— ì´ë²ˆ ê¸°ìˆ˜ë™ì•ˆì— ì»¤í”¼ì±—ì„ ì§„í–‰í•  ì—¬ìœ ê°€ ì—†ìœ¼ì…¨êµ°ìš”:) ê·¸ëŸ°ë° ì—¬ëŸ¬ë¶„ ì»¤í”¼ì±—ì„ í•œë²ˆë§Œ ì§„í–‰í•´ë„ ì»¤í”¼ì±— ë ˆë²¨ì´ +1 ëœë‹¤ëŠ” ì‚¬ì‹¤ ì•„ì‹œë‚˜ìš”? ê´€ì‹¬ìˆë˜ 4ì±„ë„ í˜¹ì€ ì½”ì–´ ì±„ë„ì—ì„œ ì»¤í”¼ì±—ì„ ì§„í–‰í•´ë³´ì‹œëŠ”ê±´ ì–´ë– ì‹¤ê¹Œìš”~?'
    elif row[18] == 1:
    #ì»¤í”¼ì±— í•œë²ˆë§Œ í•œê±°
        coffee_text = 'ì²« ì»¤í”¼ì±—ì€ ì–´ë– ì…¨ë‚˜ìš”? í•´ë‹¹ ê²½í—˜ì´ ì¢‹ì€ ê¸°ì–µìœ¼ë¡œ ë‚¨ì•˜ìœ¼ë©´ ì¢‹ê² ì–´ìš”:) ë‹¤ìŒ ì»¤í”¼ì±—ì—ì„œë„ ìƒˆë¡œìš´ ì‚¬ëŒë“¤ê³¼ ì´ì•¼ê¸°ë¥¼ ë‚˜ëˆ„ë©° ë˜ ë‹¤ë¥¸ ì˜ê°ì„ ì–»ì–´ë³´ì„¸ìš”. ëˆ„êµ¬ì™€ í•˜ì‹¤ì§€ ë§‰ë§‰í•˜ì‹œë‹¤êµ¬ìš”? ê·¸ë ‡ë‹¤ë©´ ì•„ë˜ ì§ê¶ë¶„ë“¤ê³¼ ì»¤í”¼ì±— í•´ë³´ì‹œëŠ” ê±´ ì–´ë– ì„¸ìš”?'
    elif row[18] == 2:
    #2,3ë²ˆ ì»¤í”¼ì±— ì§„í–‰
        coffee_text = 'ë²Œì¨ ì—¬ëŸ¬ ì°¨ë¡€ ì»¤í”¼ì±—ì„ ì§„í–‰í•˜ì…¨ë‹¤ë‹ˆ, ì •ë§ ë©‹ìˆì–´ìš”!ğŸŒŸ ì´ë ‡ê²Œ ë©‹ì§„ ì°¸ì—¬ë¡œ ì»¤ë®¤ë‹ˆí‹°ì— í™œë ¥ì„ ë”í•´ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤. ì•ìœ¼ë¡œë„ ì—¬ëŸ¬ë¶„ì˜ ì´ì•¼ê¸°ë¥¼ ë‚˜ëˆ„ê³ , ë‹¤ë¥¸ ë©¤ë²„ë“¤ê³¼ ë”ìš± ê¹Šì´ ì—°ê²°ë˜ëŠ” ì‹œê°„ì„ ë§Œë“¤ì–´ë³´ì„¸ìš”.  ëˆ„êµ¬ì™€ í•˜ì‹¤ì§€ ë§‰ë§‰í•˜ì‹œë‹¤êµ¬ìš”? ê·¸ë ‡ë‹¤ë©´ ì•„ë˜ ì§ê¶ë¶„ë“¤ê³¼ ì»¤í”¼ì±— í•´ë³´ì‹œëŠ” ê±´ ì–´ë– ì„¸ìš”?'
    elif row[18] == 3:
    #ìƒìœ„ 15%ì•ˆì— ë“ 
        coffee_text = 'ì»¤í”¼ì±— ì±„ë„ì—ì„œ í™œì•½í•´ ì£¼ì…”ì„œ ì •ë§ ê°ì‚¬ë“œë ¤ìš”!ğŸ’¬ ë•ë¶„ì— ì»¤ë®¤ë‹ˆí‹°ê°€ ë” ë”°ëœ»í•˜ê³  í’ì„±í•´ì§€ê³  ìˆë‹¤ëŠ”ê±° ì´ë¯¸ ì•„ì‹œì£ ~?! ì´ë¯¸ ë§ì€ ë©¤ë²„ë“¤ê³¼ ì»¤í”¼ì±—ì„ í•˜ì…¨ì§€ë§Œ, ì•ìœ¼ë¡œë„ ê¸°ëŒ€í• ê²Œìš”. ê³„ì†í•´ì„œ í™œë°œí•œ êµë¥˜ì™€ ê´€ê³„ë¥¼ ë§Œë“¤ì–´ ë‚˜ê°€ì£¼ì„¸ìš”. ğŸŒŸ'
           
    #ì „ì²´ ë ˆë²¨ì— ë”°ë¥¸ ì¶”ê°€ ë¬¸êµ¬ ì‘ì„±
    #group rank(0~3)
    if row[20] == 1:
    #ìƒìœ„ 10%	ìƒìœ„ 10%ì¸ê±° ë§ì”€ë“œë¦¬ë©´ì„œ í™œë°œí•œ í™œë™ ìœ ì§€ ë¶€íƒ
        final_ment  = 'ë§ˆì§€ë§‰ìœ¼ë¡œ ì—¬ëŸ¬ë¶„ë“¤ì—ê²Œë§Œ ë§ì”€ë“œë¦¬ëŠ”ê±´ë°..(ì†ë‹¥ì†ë‹¥) ê¸€ë˜ í™œë™ì§€ìˆ˜ ìƒìœ„ 10%ì•ˆì— ë“œì…¨ì–´ìš”~ ëŠ˜ í™œë°œí•˜ê²Œ í™œë™í•´ ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤. ë‚¨ì€ ê¸°ê°„ë„ ì‘ì›í• ê²Œìš”! ìƒˆí•´ ë³µ ë§ì´ ë°›ìœ¼ì„¸ìš”!'
    elif row[20] == 2:
        final_ment  = 'ë§ˆì§€ë§‰ìœ¼ë¡œ ê¸€ë˜ì—ì„œ ì—¬ëŸ¬ë¶„ë“¤ì€ ì–´ë–¤ í™œë™ë“¤ì„ ë” í•˜ê³  ì‹¶ìœ¼ì‹ ê°€ìš”? ì•ìœ¼ë¡œ í™œë°œí•œ í™œë™ì„ ì‘ì›í•˜ë©° ë¬¼ëŸ¬ê°€ë³´ê² ìŠµë‹ˆë‹¤. ì €í¬ëŠ” ê¸€ë˜ 10ê¸°ê°€ ëë‚ ì¦ˆìŒì— ë” ë°œì „ëœ ëª¨ìŠµìœ¼ë¡œ ë§Œë‚˜ìš”!ìƒˆí•´ ë³µ ë§ì´ ë°›ìœ¼ì„¸ìš”! '
    elif row[20] == 3:
    #í•˜ìœ„ 10%	ì¡°ê¸ˆì”© í™œë™ì„ ë…ë ¤í•˜ëŠ” ë©”ì„¸ì§€
        final_ment  = 'ë§ˆì§€ë§‰ìœ¼ë¡œ ê¸€ë˜ ê¸€ ì œì¶œ ë° ì»¤ë®¤ë‹ˆí‹° í™œë™ì´ ì‰½ì§€ ì•Šìœ¼ì‹œì£ ~?! í˜¹ì—¬ë‚˜ ì €í¬ê°€ ë„ìš¸ ìˆ˜ ë¶€ë¶„ì´ ìˆë‹¤ë©´ ì–¸ì œë“  ëŒ€ë‚˜ë¬´ìˆ²ì„ í†µí•´ ì•Œë ¤ì£¼ì„¸ìš”. ë‚¨ì€ ê¸°ê°„ë™ì•ˆì—ë„ ì¡°ê¸ˆì”© ê´€ì‹¬ì„ ê°€ì ¸ì£¼ì‹¤ê±°ë¼ ë¯¿ì„ê²Œìš”. ì €í¬ëŠ” ê¸€ë˜ 10ê¸°ê°€ ëë‚ ì¦ˆìŒì— ë” ë°œì „ëœ ëª¨ìŠµìœ¼ë¡œ ë§Œë‚˜ìš”! ìƒˆí•´ ë³µ ë§ì´ ë°›ìœ¼ì„¸ìš”!'
    else:
        final_ment  = f'ë§ˆì§€ë§‰ìœ¼ë¡œ ì—¬ëŸ¬ë¶„ë“¤ì—ê²Œë§Œ ë§ì”€ë“œë¦¬ëŠ”ê±´ë°..(ì†ë‹¥ì†ë‹¥) ê¸€ë˜ í™œë™ì§€ìˆ˜ íƒ‘ë­ì»¤ì„¸ìš”!! ì´ë²ˆ 10ê¸°ë™ì•ˆ ì»¤í”¼ì±—, ì œì¶œ, í™œë™ ê·¸ ì–´ëŠê²ƒ í•˜ë‚˜ ë†“ì¹˜ì§€ì•Šê³  ìµœê³ ë ˆë²¨ì„ ë‹¬ì„±í•˜ì…¨ë‹¤ë‹ˆ ì§„ì§œ ë©‹ìˆì•„ìš”~  ë‚¨ì€ ê¸°ê°„ë„ í™œë°œí•œ í™œë™ì„ ì‘ì›í•˜ë©° ë¬¼ëŸ¬ê°€ë³´ê² ìŠµë‹ˆë‹¤. ìƒˆí•´ ë³µ ë§ì´ ë°›ìœ¼ì„¸ìš”!'
    
    active_imoji = 'â¤ï¸â€ğŸ”¥' * int(row[16])
    submit_imoji = 'âœğŸ»' * int(row[17])
    coffee_imoji = 'â˜•ï¸' * int(row[18])

    text = f'''
    ì•ˆë…•í•˜ì„¸ìš” {row[12]}ë‹˜! ê¸€ë˜ë„ ì´ì œ ì ˆë°˜ì´ ë„˜ëŠ” ì‹œê°„ì„ í•¨ê»˜ í•´ì™”ëŠ”ë°ìš”~ ë‚¨ì€ ì‹œê°„ë“¤ë„ í•¨ê»˜ í•´ì£¼ì‹¤ ì—¬ëŸ¬ë¶„ë“¤ì„ ìœ„í•´ ì§€ë‚œ 4ê°œì›” ë™ì•ˆì˜ í™œë™ë‚´ì—­ì„ ì •ë¦¬í•´ë³´ì•˜ìŠµë‹ˆë‹¤.ğŸ‘

    > ğŸš© *{row[12]}ë‹˜ì˜ ê¸€ë˜ ë ˆë²¨*
        â€¢ í™œë™ ë ˆë²¨(1~4): {active_imoji}
        â€¢ ê¸€ ì œì¶œ ë ˆë²¨(1~4): {submit_imoji}
        â€¢ ì»¤í”¼ì±— ë ˆë²¨(0~3): {coffee_imoji} 
        

    > ğŸ” *{row[12]}ë‹˜ì˜ í™œë™ ìš”ì•½* 
        â€¢ {row[12]}ë‹˜ì€ ì´ {row[6]} ê°œì˜ ê¸€ê³¼ {row[7]} ê°œì˜ ì“°ë ˆë“œ {row[8]} ê°œì˜ ì´ëª¨ì§€ë¥¼ ë‚¨ê²¨ì£¼ì…¨ì–´ìš”.
        â€¢ {interest_text}

    > ğŸ“ *{row[12]}ë‹˜ì˜ ê¸€ ì œì¶œ ë‚´ì—­*
        â€¢ {submit_text} ë²”ë¡€: ğŸ“¬(ì œì¶œì™„ë£Œ), ğŸ“­(íŒ¨ìŠ¤), ğŸ’¸(ì°¨ê°)
        â€¢ ì´ {row[15]}íšŒ ì œì¶œ ì™„ë£Œ, {row[14]}íšŒ íŒ¨ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì…¨ì–´ìš”. 
        â€¢ {submit_add_text}ğŸ’ªğŸ»ğŸ’ªğŸ»
    
    > â˜•ï¸ *{row[12]}ë‹˜ì˜ ì»¤í”¼ì±— ë‚´ì—­*
        â€¢ {row[12]}ë‹˜ì˜ ì»¤í”¼ì±— íšŸìˆ˜ëŠ” {row[13]} íšŒ ì…ë‹ˆë‹¤.
        â€¢ {coffee_text}
    
    > ğŸ‘« *{row[12]}ë‹˜ì˜ í™˜ìƒì˜ ì§ê¶*
        â€¢ ì§€ê¸ˆê¹Œì§€ ë‚˜ì—ê²Œ ê´€ì‹¬ì„ ë³´ì—¬ì¤€ íŒ”ë¡œì›Œ top 5ëª…ì„ ì†Œê°œí•´ë“œë¦´ê²Œìš”. í˜¹ì‹œ ì¹œí•´ì§€ê³  ì‹¶ìœ¼ì‹  ë¶„ì´ ìˆë‹¤ë©´ ì»¤í”¼ì±—ì„ ì‹ ì²­í•´ë³´ëŠ” ê±´ ì–´ë– ì„¸ìš”? ì‚¬ì´ë„ ëˆë…í•´ì§€ê³  í¬ì¸íŠ¸ë„ ì–»ëŠ” 1ì„ 2ì¡°ì˜ ê¸°íšŒ
        â€¢ ğŸ’˜ë‚˜ì—ê²Œ ë§ì€ ê´€ì‹¬ì„ ë³´ë‚´ì¤€ íŒ”ë¡œì›ŒğŸ’˜: {row[11]}

    ê¸€ë˜ 10ê¸°ë™ì•ˆ {row[2]} ì½”ì–´ ì±„ë„ì— í™œë™í•˜ì‹œë©° ê´€ì‹¬ê°€ì ¸ì£¼ì…”ì„œ ê°ì‚¬ë“œë¦½ë‹ˆë‹¤. 
    ì„¤ ì—°íœ´ë¥¼ ë§ì•„ ê³„íší•˜ê³  ê³„ì‹ ê²Œ ìˆìœ¼ì‹ ê°€ìš”? ë‹¤ ì¢‹ì§€ë§Œ ì´ë²ˆ ê¸´ ì—°íœ´ë™ì•ˆ í‘¹ ì‰¬ëŠ” ê²ƒë„ ìŠì§€ë§ˆì…”ìš”~ğŸ™‡ğŸ»â€â™€ï¸
    {final_ment}
    '''
    result = send_message_to_user(row[0],text)
    text_list.append(text)
    ts_list.append(result)
    
    cnt += 1
    df_temp = pd.DataFrame({'text':text_list,'ts':ts_list})    
    if cnt % 50 == 0:
        time.sleep(1)
        print(f'{cnt}ëª… ì „ë‹¬ì™„ë£Œ')
pd.concat([df_sended,df_temp]).to_csv('./message_sended.csv', encoding = 'utf-8-sig')
print(f'{cnt}ëª… ì „ë‹¬ì™„ë£Œ')
end = time.time()
print(round(end - start))